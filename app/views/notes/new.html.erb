<div class="container">
  <div class="col-lg-6 col-lg-offset-3">
    <div id="map">

    </div>
    <%= render 'form' %>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    var map = L.map('map').setView([29.86, 121.56], 13);
    var position = [];
    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    L.marker([29.86, 121.56]).addTo(map)
        .bindPopup('A pretty CSS3 popup.<br> Easily customizable.')
        .openPopup();
    function onLocationFound(e) {
      var marker = L.marker(e.latlng, {draggable: true})
                    .addTo(map)
                    .bindPopup("请选择当前位置").openPopup()
                    .on('dragend', function (event) {
                      var marker = event.target;
                      var latlng = marker.getLatLng().toString();
                      position.push(latlng);
                    });
                  }
    map.on('locationfound', onLocationFound);
    var popup = L.popup();
    function onMapClick(e) {
          popup
              .setLatLng(e.latlng)
              .setContent("你点击的位置在 " + e.latlng)
              .openOn(map);
    }
    map.on('click', onMapClick);
    $('#locate').click(function () {
          var lng =  1;
          var lat =  2;
          $('#note_lng').val(lng);
          $('#note_lat').val(lat);
      });
    $('#reset').click(function () {
          var lng =  [];
          var lat =  [];
          $('#note_lng').val(lng);
          $('#note_lat').val(lat);
        });


  });

</script>
